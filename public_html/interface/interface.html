<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="/styleinterface.css">
    <link rel="stylesheet" type="text/css" href="/public_html/styleinterface.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.min.css"> 
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.all.min.js"></script>


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>




   
    <title>Skybank</title>
</head>
<body>
    <div id = "txt1"> </div>
    <div class="div1">
    <div class="menu1">

     

  


        <nav><ul class="menu">
        
<div class="menu2"><p id = "nomedeuser">Nome do Usuário</p></div>
    <li class="menu2" id = "menuinicio"><a href="#"><img src="/imagens/icones/inicio.png" alt="" class="imgmenu">      Inicio</a> </li>
    <li class="menu2" id = "menumov"><a href="#"><img src="/imagens/icones/Transf menu.png" alt="" class="imgmenu">      Movimentações</a></li>
    <li class="menu2" id = "menuperfil"><a href="#"><img src="/imagens/icones/Transf menu.png" alt="" class="imgmenu">      Perfil</a></li>
    <li class="menu2" id = "menusup" ><a href="#"><img src="/imagens/icones/sup.png" alt="" class="imgmenu">     Suporte </a></li> 

    </ul>
    </nav>
</div></div>
<div class = tarja>
<img id="logo" src="/imagens/logo.png" alt="">


</div>

    <!-- <div class="interFace">
        <p id="saldotxt">Saldo em conta </p>

        <p id = "sifraosaldo" >R$</p>  <span id="saldoconta">Carregando...</span>
        
</div> -->
<div class="interFace">
  <p id="saldotxt">Saldo em conta</p>
  <p id="sifraosaldo">R$</p>
  <span id="saldoconta">Carregando...</span>
</div>

    <div class="botoes">
    <input type="button" value="Pix" class="btninter" id="pix">
    <input type="button" value="Depósito" class="btninter" id="dep">
    <input type="button" value="Saque" class="btninter" id="saq">
    <input type="button" value="Transferência" class="btninter" id="transf">
    <input type="button" value="Pagamento" class="btninter" id="pag">
   

</div>

<div class="perfiluser" id="perfiluser">
  <p class="txtperfil">Bem-vindo ao seu Perfil</p>

  <button id="buscarInformacoesUsuario">Ver dados da conta</button>

  <p class="perfilInfo">Suas informações:</p>
  <p class="perfilInfo" id="perfilnome">Nome: </p> <p id="nomeUsuario" class="perfildados">******</p>
  
  <p class="perfilInfo" id="perfilemail">Email: <p id="emailUsuario" class="perfildados">******@******</p></p>
  <p class="perfilInfo" id="perfilcpf">CPF: <p id="cpfUsuario" class="perfildados">********</p></p>
  <p class="perfilInfo" id="perfilchavepix">Chave PIX: <p id="chavePixUsuario" class="perfildados">********</p></p>
  <p class="perfilInfo" id="perfilagencia">Agência: <p id="agenciaUsuario" class="perfildados">****</p></p>
  <p class="perfilInfo" id="perfilconta">Conta: <p id="contaUsuario" class="perfildados">******</p></p>
  

  <p class="perfilInfo">Cadastre sua Chave Pix!</p>
  <input type="text" name="cadastraNovaChave" id="cadastraNovaChave" class="btnsperfil" placeholder="R$">
  <input type="button" value="OK" id="cadastrarPixButton" class="btnsperfil">
</div>
</div>

</div>



<div class="mov"> 
 <p id="mov1"> </p>   
</div>

<div class="pixtransf">
  <div class="pix2">
    <br>
    <p id="txtpix">Para quem você deseja transferir?</p>
  </div>


  <p class="txtpix1">Digite a chave PIX do destinatário:</p>
  <input type="text" name="enviaPix" id="entraemail" placeholder="Chave PIX" class="btnspix">

  <div id="errochave" class="errospix"></div>

  <p class="txtpix1">Digite o valor:</p>
  <input type="number" value="" id="entrapix" placeholder="R$" class="btnspix">

  <input type="button" value="Transferir" id="botaotransf" class="btnspix" />

  <div id="entrenumero" class="errospix">
  </div>
</div>






</div>

    <!-- DEPOSITO -->
    <div class="deposit">

      <p class = "txtdep">Confira os valores de Depósito logo abaixo: </p>
      <label for="deposito1"></label>
      <!-- <input type="number" nome = R$ id="dep1" placeholder="Valor Desejado " class="btnsdep"> -->

      <div class="vdef">
        <div class="valor200">
      <input type="button" onclick="bol50()" value="R$ 50,00" class="btndepo" id="btn50">
      <input type="button" onclick="bol100()" value="R$ 100,00" class="btndepo" id="btn100">
      <input type="button" onclick="bol200()" value="R$ 200,00" class="btndepo" id="btn200">
        </div>
      <br>
        <div class="valor1000">
      <input type="button" onclick="bol300()" value="R$ 300,00" class="btndepo" id="btn300">
      <input type="button" onclick="bol500()" value="R$ 500,00" class="btndepo" id="btn500">
      <input type="button" onclick="bol1000()" value="R$ 1.000,00" class="btndepo" id="btn1000">
        </div>
      </div>

      <style>
        .btndepo{
          width: 105px;
          padding: 10px;
          border-radius: 10px;
          margin-left: 4%;
          margin-bottom: 20px;
        }
        .vdef{
          padding-left: 50px;
        }
        .valor200{
          padding-right: 50px;
        }
        .valor100{
          padding-right: 50px;
        }
      </style>
       <!-- <form method="post" action="/realizar-deposito">
          <p class="txtdep1">Digite o valor:</p>
          <input type="number" value="" id="dep1" placeholder="R$" class="btnsdep">
          <button type="submit" id="boletogerado" class="btnsdep">Confirmar Depósito</button>
        </form>  -->
        
        
        
  
      <div id="errodep"></div>
  
      <!-- <label for="deposito1">R$</label> -->
  
      <!-- <input type="button" value="Confirmar" id="boletogerado"  class="btnsdep"> -->
  
      <div id = "salvaboleto" class="btnsdep"></div>
      
      
  </div>


  <!-- ----------------- CHATBOX DO SKYBANK ----------------- -->

  <button class="float-buttonc"><p id="qchat">?</p></button>

  <div class="modalchat">
      <div class="modalchat-contentc">
          <span class="close-buttonc">×</span>

          <div class="containerchat">
          <div class="headerchat">
            <h1>SkyBank</h1>
        </div>

        <div class="bodychat">
            <div class="message"><img id = "imgassist" src="/imagens/assistente1.png"  alt=""> <p id = "msgassist">Olá, sou a Violeta, assistente virtual do Skybank! Como posso ajudar?</p></div>
         <li>1 - Pix</li>
            <br>
            <li>2 - Chaves Pix</li>
            <br>
            <li>3 - Transferência</li>
            <br>
            <li>4 - Depósito</li>
            <br>
            <li>5 - Saque</li>
            <br>
            <li>6 - Faq de ajuda</li>
            <br>
           
        </div>
        <div class="footerchat">
            <form>
                <input type="text" id="userInput" placeholder="Digite sua mensagem...">
                <button id="sendButton">Enviar</button>
            </form>
        </div>
      
        
    </div>
   <a class="volte" href="http://127.0.0.1:5503/Interface/interface.html">Clique aqui e volta ao Skybank!</a>
      </div>
  </div>







<div class="areatransf">
<p class="transfbtn" class="errosted"> Para quem Você deseja Transferir ? </p>
<input type="text" value="" id="caixaNome" placeholder="Nome:" class="transfbtn">
<div id="nometed" class="errosted"></div>
<br>
<input type="number" name="" id="caixaCpf" placeholder="CPF:" class="transfbtn">
<div id="cpfted" class="errosted"></div>
<br>
<input type="number" name="" id="caixaAgencia" placeholder="Agência:" class="transfbtn">
<div id="agenciated" class="errosted"></div>
<br>
<input type="number" name="" id="caixaConta" placeholder="Conta:" class="transfbtn">
<div id="contated" class="errosted"></div>
<br>
<input type="number" name="" id="caixaValor" placeholder="R$" class="transfbtn">
<div id="valorted" class="errosted"></div>
<input type="button" value="Transferir" id="btnted" class="transfbtn">
</div>


<div class="areapag">
    <p class="colunaspag" >Realize aqui seu pagamento:</p>
    <form id="form-pagamento" class="colunaspag">
      <label for="codigo" class="colunaspag">Código de barras:</label>
      <input type="text" id="codigo" name="codigo" class="colunaspag"><br><br>
      <button type="button" id="gerar" class="colunaspag">Colar Código do Boleto</button>
      <br><br>
      <button type="button" id="pagar" class="colunaspag">Pagar</button>
    </form>

</div>

</div>

<div class="suporte">
    <p class="suportstyle"> Você esta na Central de Atendimento!</p> 
    <p class="suportstyle">Há dúvidas ?  <a href="http://127.0.0.1:5503/Faq%20de%20ajuda/faq.html">Veja nossa FAQ</a>.</p>

    <p class="suportstyle">Ainda precisa de ajuda? Fale conosco através dos nosso canais de atendimento: </p>
    <!-- <input type="text" name="" id="btnfaleconosco" placeholder="Entre com sua Dúvida aqui: " class="suportstyle"> -->
    <!-- <input type="button" value="Enviar" class="suportstyle" id="enviaduvida"> -->
    
    <p class="suportstyle">        -Telefone: 2555-3011;</p> 
    <p class="suportstyle">        -E-mail: Skybank@Skybank.com.br.</p> 

</div> 


<!-- SAQUE -->
<div id ="btnssaq">
    <p class="saquetxt" >Realize seu Saque</p>
    <p class = "txtpix1">Digite o valor:</p>
    <input type="number" value="" id = "saqueInput" placeholder="R$" >
    <button id="saqueButton">Realizar Saque</button>
    <button id="mostraMapa">Bancos Próximos</button>

    <div id="googlemap" style="display:none;">
        <iframe src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCNveGQ9bfpKFwWzQLLftrR9hNiHwdqQG8&amp;q=R. Inácio Maciel, 308 - Vila Jacuí, São Paulo - SP CEP 08060-010" allowfullscreen="" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
    </div>    

</div>
<div class="movimentos">
    <ul id="lista-transferencias">
    
    
        <div class="transferencia" id="transf1">
        <pre class="txtmov">  Transferência Pix enviada                                                                                        11/05          -R$200</pre></div>
        <div class="transferencia" id="transf2">
        <pre class="txtmov">  Transferência Pix enviada                                                                                        05/05          -R$450</pre></div>
        <div class="transferencia" id="transf3" >
        <pre class="txtmov">  Transferência Pix enviada                                                                                        10/04          -R$1100</pre></div>
      </ul>
      
    
      <div class="popup-wrapper">
        <div class="popup">
            <div class="popup-close">x</div>
            <div class="popup-content">
                <h2>Comprovante de Transferência</h2>
                <h2>Destinatario:</h2>
                <p class="movDados">Nome:Julio </p>
                <p class="movDados">Data:11/05/2023 </p>
                <p class="movDados">Instituição:Banco Santander</p>
            
                <h2>Origem</h2>
                <p class="movDados">Usuario</p>
                <p class="movDados">CPF: ***.037.968-**</p>
                <p class="movDados">Instituição: Skybank</p>
                <div id="valormov">Valor Transferido: -R$200</div>
                  
            </div>
        </div>
      </div>

    
      <div class="popup-wrapper2">
        <div class="popup">
            <div class="popup-close">x</div>
            <div class="popup-content">
                <h2>Comprovante de Transferência</h2>
                <h2>Destinatario:</h2>
                <p class="movDados">Nome:Guilherme </p>
                <p class="movDados">Data:05/05/2023 </p>
                <p class="movDados">Instituição: PicPay</p>
            
                <h2>Origem</h2>
                <p class="movDados">Usuario</p>
                <p class="movDados">CPF: ***.037.968-**</p>
                <p class="movDados">Instituição: Skybank</p>
                <div id="valormov">Valor: -R$450</div>
                
            </div>
        </div>
      </div>

    
      <div class="popup-wrapper3">
        <div class="popup">
            <div class="popup-close">x</div>
            <div class="popup-content">
                <h2>Comprovante de transferência</h2>
                <h2>Destinatario:</h2>
                <p class="movDados">Nome:Camila</p>
                <p class="movDados">Data:10/04/2023 </p>
                <p class="movDados">Instituição: Banco Ítau</p>
            
                <h2>Origem</h2>
                <p class="movDados">Usuario</p>
                <p class="movDados">CPF: ***.037.968-**</p>
                <p class="movDados">Instituição: Skybank</p>
                <div id="valormov">Valor Transferido: -R$1100</div>
                
                
            </div>

            
        </div>
        
      </div>







      <!-- <div id="detalhes-transferencia">

        <p id="descricao-transferencia"></p>
        <p id="valor-transferencia"></p>
        <p id="remetente-transferencia"></p>
        <p id="destinatario-transferencia"></p>
        <p id="data-transferencia"></p>
        <p id="conta-origem"></p>
        <p id="conta-destino"></p> -->
      </div>
          
</div>
<!-- <div class="perfil">
    <p>Seus Dados </p>
    <p>Nome: </p>
    <p>E-mail: </p>
    <p>Cpf: </p>
    <p>Endereço: </p>
    <p>Chaves cadastradas: </p>
</div> -->




</div>
<script src="/interface/perfil.js"></script>
<script src="/interface/saldoatt.js"></script>
<script src="/interface/deposito.js" defer></script>
<script src="/interface/menu.js" defer></script>
<script src="/interface/pagamento.js" defer></script>
<script src="/interface/pix.js" defer></script>
<script src="/interface/saque.js" defer></script>
<script src="/interface/suporte.js" defer></script>
<script src="/interface/transferencia.js" defer></script>
<script src="/interface/movimentos.js" defer></script>
<script src="/interface/chatscript.js"></script>
<script src="/public_html/interface/interfacescriptsfinal.js" defer></script>


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js" integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js" integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ" crossorigin="anonymous"></script>



<link href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma/bulma.css" rel="stylesheet">
<script src="sweetalert2/dist/sweetalert2.min.js"></script>

<footer>
    <div><p>&copy; Copyright 2023 Skybank. Todos os direitos reservados.</p> <img src="/imagens/logo.png" alt="teste" id="easteregg"> </div>

</footer>
</body>
<script>
  // Função para buscar o saldo do usuário e Mostrar Saldo em conta
  function buscarSaldo() {
    fetch('/buscar-saldo') // Rota correta para buscar o saldo
      .then((response) => response.json())
      .then((data) => {
        const saldoElement = document.getElementById('saldoconta');
        saldoElement.textContent = data.saldo;
      })
      .catch((error) => {
        console.error('Erro ao buscar saldo:', error);
      });
  }

  // Chame a função para buscar o saldo quando a página for carregada
  window.addEventListener('load', buscarSaldo);

// Adicione um evento de clique ao botão "Transferir"
const botaoTransferir = document.getElementById('botaotransf');
botaoTransferir.addEventListener('click', async () => {
  const chavePixDestino = document.getElementById('entraemail').value;
  const valorTransferencia = parseFloat(document.getElementById('entrapix').value);
  const emailOrigem = 'Kylers@skybank'; // AQUI É O E-MAIL DO USUARIO DE ORIGEM!!!!!!!!!
  const saldoConta = parseFloat(document.getElementById('saldoconta').textContent);

  if (!chavePixDestino || isNaN(valorTransferencia) || valorTransferencia <= 0) {
    document.getElementById('errochave').textContent = 'Preencha os campos corretamente';
  } else if (valorTransferencia > saldoConta) {
    // Exibir um SweetAlert informando que o saldo é insuficiente
    Swal.fire({
      icon: 'error',
      title: 'Oops...',
      text: 'Você não tem saldo para realizar essa Transferência',
      footer: '<a href="http://127.0.0.1:5503/Faq%20de%20ajuda/faq.html">Está com dificuldade para Sacar? Acesse nossa Faq</a>'
    });
  } else {
    // Verificar se a chave PIX de destino existe
    const response = await fetch('/verificar-chavepix', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        chavePixDestino: chavePixDestino,
      }),
    });

    if (response.status === 200) {
      // A chave PIX de destino existe

      Swal.fire({
        title: 'Você está prestes a finalizar sua Transferência',
        text: 'Se os dados estiverem corretos, clique em Prosseguir para continuar com a Transferência!',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        cancelButtonText: 'Cancelar',
        confirmButtonText: 'Prosseguir'
      }).then(async (result) => {
        if (result.isConfirmed) {
          // Realize a transferência
          const transferenciaResponse = await fetch('/realizar-transferencia', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              chavePixDestino: chavePixDestino,
              valorTransferencia: valorTransferencia,
              emailOrigem: emailOrigem,
            }),
          });

          if (transferenciaResponse.status === 201) {
            const data = await transferenciaResponse.json();
            const novoSaldo = data.saldo;

            // Atualize o saldo na interface
            document.getElementById('saldoconta').textContent = novoSaldo;
            console.log('Transferência realizada com sucesso! Novo saldo:', novoSaldo);
            document.getElementById('errochave').textContent = ' ';

            // Exiba um SweetAlert de sucesso
            Swal.fire('Obrigado por usar nosso Banco!', 'Sua Transferência foi realizada com sucesso!', 'success');
          } else {
            console.error('Erro ao realizar a transferência:', transferenciaResponse.statusText);
            // Manipule o erro e exiba uma mensagem de erro ao usuário, se necessário
          }
        }
      });
    } else {
      // A chave PIX de destino não existe, mostre uma mensagem de erro usando o SweetAlert
      Swal.fire('Chave PIX não localizada', 'Chave PIX de destino não localizada. Digite uma chave PIX válida.', 'error');
      document.getElementById('errochave').textContent = 'Chave PIX de destino não cadastrada.';
    }
  }
});


    
window.addEventListener('load', () => {
  const email = 'Kylers@skybank'; // Substitua pelo e-mail que deseja buscar

  fetch(`/buscar-nomesocial/${email}`)
    .then((response) => response.json())
    .then((data) => {
      const nomedeuser = document.getElementById('nomedeuser');
      nomedeuser.textContent = "Olá " + data.nomesocial +", Seja Bem vindo!";
    })
    .catch((error) => {
      console.error('Erro ao buscar nome social:', error);
    });
});



</script>

</html>